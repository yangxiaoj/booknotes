# 从零学量化48：QuantStats库之金融指标中文指南（四）
QuantStats 是一个开源的 Python 库，专门为量化交易策略的分析和开发而设计。这个库提供了一系列简单易用的函数，允许你计算各种性能指标，生成美观的图表，以及进行深度的策略分析，是量化研究常用的工具。

QuantStats 由3个主要模块组成，其中 quantstats.stats 模块用于计算各种金融指标，QuantStats库实现的金融指标非常多，因此分为若干篇来写。

本文为第四篇，继续介绍QuantStats库的金融指标函数（按字母排序）：
### 25. kelly_criterion(returns, prepare_returns=True)
kelly_criterion 函数用于计算基于Kelly准则（即：凯利公式）推荐的给定策略应分配的最大资本金额。

以下是对参数的解释：

- returns：投资组合或策略的回报率序列。
- prepare_returns：是否对 returns 进行预处理，将价格数据转换为回报率，并根据需要将回报率转换为超额回报。同时，它也会对正无穷、负无穷和NaN数据进行清理。

这个函数使用了为投资设计的Kelly准则公式，它与为投注设计的原始公式不同。投资公式考虑了回报的平均值和标准差，而投注公式只考虑赢和输的概率。
### 26. kurtosis(returns, prepare_returns=True)
kurtosis 函数是QuantStats库中的一个函数，用于计算回报率的峰度。峰度（Kurtosis）是统计数据分布形态的测度，用于描述数据集中峰值的尖锐程度相对于正态分布的情况。峰度高表示数据分布有更尖的峰和更厚的尾，而低峰度表示数据分布有更平坦的峰和更薄的尾。具体来说，函数的定义和用法如下：

- returns：这是一个数组或序列，代表了投资组合或资产的回报率。这个数据可以是价格数据，也可以是已经计算好的回报率数据。
- prepare_returns：这是一个布尔值，用于决定是否需要对returns进行预处理。如果设为True，函数会将returns进行预处理，将价格数据转换为回报率，并进行一些数据清理工作。

函数的返回值是returns的峰度值，这个值描述了回报率分布的峰态特性。如果回报率分布相对于正态分布有更尖的峰，峰度值会大于0；如果回报率分布相对于正态分布有更平坦的峰，峰度值会小于0。

这个函数是金融统计分析中的一个常用工具，可以用来测量资产回报的风险特性。回报率的峰度可以提供关于资产价格极端变动的风险的信息，例如，高峰度可能意味着资产价格有更大的尾部风险，即极端大的正回报或负回报的可能性更高。
### 27. max_drawdown(prices)
max_drawdown函数是QuantStats库中的一个函数，它用于计算投资组合或者资产的最大回撤。最大回撤是指从投资组合或资产的峰值下跌到谷值的最大幅度。具体来说，函数的定义和用法如下：

- prices：这是一个数组或序列，代表了投资组合或资产的价格数据。

函数的返回值是prices的最大回撤值，这个值描述了投资组合或资产从峰值下跌到谷值的最大幅度。这个值通常为负数，因为它表示损失的幅度。绝对值越大，表示回撤越深，风险越高。

这个函数是金融统计分析中的一个常用工具，可以用来测量投资组合或资产的风险特性。最大回撤可以提供关于投资组合或资产在最坏情况下可能损失的信息，对于评估投资策略的风险和投资者的风险承受能力非常有用。
### 28. monthly_returns(returns, eoy=True, compounded=True, prepare_returns=True)
monthly_returns函数是QuantStats库中的一个函数，它用于计算投资组合或资产的月度回报率。具体来说，函数的定义和用法如下：

- returns：这是一个数组或序列，代表了投资组合或资产的回报率。这个数据可以是价格数据，也可以是已经计算好的回报率数据。
- eoy：这是一个布尔值，用于决定是否在年底（End Of Year）计算月度回报。如果设为True，函数会在每年的最后一个月计算月度回报；如果设为False，函数会在每个月的最后一天计算月度回报。
- compounded：这是一个布尔值，用于决定是否计算复利月度回报。如果设为True，函数会计算复利月度回报；如果设为False，函数会计算简单月度回报。
- prepare_returns：这是一个布尔值，用于决定是否需要对returns进行预处理。如果设为True，函数会将returns进行预处理，将价格数据转换为回报率，并进行一些数据清理工作。

函数的返回值是returns的月度回报率，这个值描述了投资组合或资产每月的盈利或亏损情况。如果compounded为True，这个值是复利月度回报率，反映了投资收益的复利效应；如果compounded为False，这个值是简单月度回报率，只考虑了投资收益的本金效应。
### 29. omega(returns, rf=0.0, required_return=0.0, periods=252)

omega 函数是QuantStats库中的一个函数，它用于计算投资策略的Omega比率。Omega比率是一个用于衡量投资组合表现的风险调整收益率指标，它考虑了投资组合收益分布的偏度和峰度。

具体来说，Omega比率是投资组合在实现超过目标回报率的回报和未达到目标回报率的回报之间的比率。如果Omega比率大于1，那么投资组合在目标回报率以上的回报更可能发生；如果Omega比率小于1，那么投资组合未达到目标回报率的回报更可能发生。

函数的定义和用法如下：

- returns：这是一个数组或序列，代表你的投资组合或资产的回报率。这个数据可以是价格数据，也可以是已经计算好的回报率数据。
- rf：这是一个数值，代表无风险利率。如果 rf 大于0，那么函数会将回报率减去无风险利率，得到超额回报。默认值为0。
- required_return：这是一个数值，代表你期望的回报率或目标回报率。默认值为0。
- periods：这是一个数值，代表回报率的计算周期。例如，如果 returns 是日回报率，那么 periods 应该设为252（一年交易日的平均数）；如果 returns 是月回报率，那么 periods 应该设为12。默认值为252。

函数的返回值是 returns 的Omega比率，这个值描述了投资组合在实现超过目标回报率的回报和未达到目标回报率的回报之间的比率。

Omega比率是一个非常有用的风险调整收益率指标，它可以提供关于投资组合超额回报概率的信息，对于评估投资策略的风险和收益特性非常有用。
### 30. outlier_loss_ratio(returns, quantile=0.01, prepare_returns=True)
outlier_loss_ratio函数是QuantStats库中的一个函数，它用于计算投资组合或资产的异常损失比率。这个比率是负回报的第一分位数（即最小的1%的回报）与负回报的平均值之间的比率。这个比率可以提供有关投资组合或资产的尾部风险的信息，具体来说，它反映了极端负回报与一般负回报的比例。

函数的定义和用法如下：

- returns：这是一个数组或序列，代表你的投资组合或资产的回报率。这个数据可以是价格数据，也可以是已经计算好的回报率数据。
- quantile：这是一个数值，代表你希望计算的分位数。默认值为0.01，即第一分位数。
- prepare_returns：这是一个布尔值，用于决定是否需要对returns进行预处理。如果设为True，函数会将returns进行预处理，将价格数据转换为回报率，并进行一些数据清理工作。

函数的返回值是returns的异常损失比率，这个值描述了极端负回报与一般负回报的比例。如果这个比率较大，那么可能表示投资组合或资产的尾部风险较高，即极端负回报的可能性较大。
### 31. outlier_win_ratio(returns, quantile=0.99, prepare_returns=True)
outlier_win_ratio函数是QuantStats库中的一个函数，它用于计算投资组合或资产的异常收益比率。这个比率是由正回报的第99分位数（即最大的1%的回报）与正回报的平均值之间的比率计算得出。这个比率可以提供有关投资组合或资产的尾部收益的信息，具体来说，它反映了极端正回报与一般正回报的比例。

函数的定义和用法如下：

- returns：这是一个数组或序列，代表你的投资组合或资产的回报率。这个数据可以是价格数据，也可以是已经计算好的回报率数据。
- quantile：这是一个数值，代表你希望计算的分位数。默认值为0.99，即第99分位数。
- prepare_returns：这是一个布尔值，用于决定是否需要对returns进行预处理。如果设为True，函数会将returns进行预处理，将价格数据转换为回报率，并进行一些数据清理工作。

函数的返回值是returns的异常收益比率，这个值描述了极端正回报与一般正回报的比例。如果这个比率较大，那么可能表示投资组合或资产的尾部收益较高，即极端正回报的可能性较大。

（未完待续）