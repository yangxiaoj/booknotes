# 量化实战入门112—趋势类指标详解：CHOP / CKSP / Decay 

本文介绍以下几个技术指标：CHOP、CKSP、Decay。这几个指标都属于趋势（ Trend）类型的指标，这类主要用于识别和跟踪市场的主要趋势。这些指标可以帮助投资者确定市场的方向（上升、下降或者横盘），从而帮助投资者决定何时进入或退出市场。

本系列中的各项指标都可以通过调用 Pandas TA 库来实现，Pandas TA 库的使用详见《量化宝藏工具箱：技术指标库 Pandas TA 教程》一文。
## 1. CHOP（Choppiness Index，即震荡指数）
Choppiness Index (CHOP)，即震荡指数，是由澳大利亚商品交易员 E.W. Dreiss 创建的，用于判断市场是否处于震荡（横盘交易）或趋势（向任一方向交易）中。CHOP 指标的值介于 0 和 100 之间。

CHOP 指标的计算步骤：

1）计算最高价和最低价：用滚动窗口函数计算过去指定时间周期内的最高价（HH）和最低价（LL）。

2）计算平均真实范围（ATR）的和：ATR 是一种衡量股价波动性的指标，其计算方法是取最高价、最低价和前一个交易日收盘价的最大差值。然后计算过去指定时间周期内的 ATR 的总和（ATR_SUM）。

3）计算震荡指数（CHOP）：先计算 ATR_SUM 和（HH - LL）的对数（默认使用以10为底的对数，也可以选择使用自然对数），然后相减，再乘以一个放大系数（默认为100）。最后再除以时间周期长度的对数。

以下是 CHOP 指标的主要用法：

1）判断市场状态：CHOP 指标主要用来判断市场处于趋势市还是震荡市。CHOP 值接近 100 时，表示市场处于震荡状态，交易者可以考虑使用适合横盘市场的交易策略，如套利策略；CHOP 值接近 0 时，表示市场有明显的上升或下降趋势，交易者可以考虑使用适合趋势市场的交易策略，如追踪趋势的策略。

2）判断市场转变时机：当 CHOP 指标的值从高位向下降或从低位向上升，可能表示市场状态即将发生转变。

该指标在 Pandas TA 库中的函数是：

```python 

chop(high, low, close, length=None, atr_length=None, ln=None, scalar=None, drift=None, offset=None, **kwargs)

```

## 2. CKSP（Chande Kroll Stop）
Chande Kroll Stop (CKSP) 是 一种趋势跟踪指标。CKSP 通过计算最近市场波动的平均真实范围 (ATR) 来确定你的止损点。

计算方法如下：

1）计算初步的止损点（LS0和SS0） 。CKSP 指标首先计算过去 p 期内的最高价和最低价，然后使用这些价格和平均真实范围（ATR）来计算初步的止损点。

长期止损点的初步计算方法如下：

```python 

LS0 = high.rolling(p).max() - x * ATR(length=p)

``` 

短期止损点的初步计算方法如下：

```python 

SS0 = low.rolling(p).min() + x * ATR(length=p)

```

这里，ATR(length=p) 表示过去 p 期内的平均真实范围，x 是一个系数，用来调整 ATR 的影响。

2）计算最终的止损点（LS和SS） 。CKSP 指标使用滚动窗口函数计算过去 q 期内的 LS0 和 SS0 的最大值和最小值，得到最终的止损点。

长期止损点的最终计算方法如下：

```python 

LS = LS0.rolling(q).max()

```

短期止损点的最终计算方法如下：

```python 

SS = SS0.rolling(q).min()

```

以下是 CKSP 指标的主要用法：

1）确定止损点：CKSP 指标计算出的长期止损点（LS）和短期止损点（SS）可以用来确定交易的止损点。当市场价格跌破止损点时，投资者可能需要考虑关闭仓位以防止进一步的损失。

2）判断市场趋势：CKSP 指标的长期止损点和短期止损点也可以用来判断市场的趋势。一般来说，当长期止损点上升并且高于短期止损点时，可能表示市场处于上升趋势；当长期止损点下降并且低于短期止损点时，可能表示市场处于下降趋势。

该指标在 Pandas TA 库中的函数是：

```python 

cksp(high, low, close, p=None, x=None, q=None, tvmode=None, offset=None, **kwargs)

```

## 3. Decay
Decay是一种技术分析函数，它创建了一个从先前信号（如交叉）向前衰减的移动。默认情况下，衰减是线性的，但也可以选择为指数衰减。

Decay指标的计算方法主要包含两种形式：线性衰减和指数衰减。

1）线性衰减：在线性衰减中，每个周期的衰减值是固定的。具体的计算公式为：

```python 

max(close, close[-1] - (1 / length), 0)

```

这里，close 是当前周期的收盘价，close[-1] 是上一个周期的收盘价，length 是衰减的周期数。(1 / length) 表示每个周期的衰减率，close[-1] - (1 / length) 是计算出的衰减后的值，max(close, close[-1] - (1 / length), 0) 则是取这两个值中的较大值作为衰减后的值。

2）指数衰减：在指数衰减中，每个周期的衰减值是逐渐减小的。具体的计算公式为：

```python 

max(close, close[-1] - exp(-length), 0)

```

这里，exp(-length) 表示每个周期的衰减率，close[-1] - exp(-length) 是计算出的衰减后的值，max(close, close[-1] - exp(-length), 0) 则是取这两个值中的较大值作为衰减后的值。

Decay 指标是一种技术分析工具，用于创建一个从先前信号（如交叉）向前衰减的移动。这个指标可以应用在各种不同的投资策略中，以下是一些

常见的用法：

1）信号衰减：当市场出现一些重要的技术信号（如价格突破、交叉等）时，投资者可能会对这些信号进行跟踪。然而，随着时间的推移，这些信号的影响力可能会逐渐减弱。此时，可以使用 Decay 指标来量化这种衰减过程，以帮助投资者更好地理解和利用这些信号。

2）趋势跟踪：Decay 指标也可以用于趋势跟踪策略。例如，当市场价格在一段时间内持续上升时，可以使用 Decay 指标来测量这种上升趋势的强度和持续性。如果 Decay 指标显示出明显的衰减趋势，可能表示上升趋势正在逐渐减弱，投资者可能需要考虑调整交易策略。

3）风险管理：Decay 指标也可以用于风险管理。例如，当市场价格出现重大下跌时，投资者可能会面临较大的损失风险。此时，可以使用 Decay 指标来测量这种下跌趋势的持续性和严重程度，以帮助投资者更好地管理风险。

该指标在 Pandas TA 库中的函数是：

```python 

decay(close, kind=None, length=None, mode=None, offset=None, **kwargs)

```

未完待续……